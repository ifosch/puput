#!/usr/bin/env python

import click

import picot.feed
from puput import filter_generator


@click.command()
@click.option('--to-date', is_flag=True)
@click.option('--title-starts', default='')
@click.argument('url', nargs=1)
def collect(url, to_date, title_starts):
    """This collects all messages for url applying the filter if defined."""
    entries = picot.feed.Feed(
        url,
        filter_func=filter_generator(to_date, title_starts),
    )
    for entry in entries:
        print(entry['title'])


if __name__ == '__main__':
    collect()
